<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>مسح QR Code</title>
  <style>
    /* Styling for the scanner container */
    #scannerContainer {
      position: relative;
      width: 100%;
      height: 400px;
      background-color: #000;
      display: none;
    }

    /* The camera display */
    #camera {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* The QR code scanning area */
    #scanArea {
      position: absolute;
      top: 50%;
      left: 50%;
      width: 250px;
      height: 250px;
      border: 2px dashed #fff;
      transform: translate(-50%, -50%);
      pointer-events: none;
    }

    /* Button styling */
    .button {
      padding: 10px 20px;
      background-color: #007bff;
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
      margin-top: 10px;
    }

    /* Hidden input for file selection */
    #imageInput {
      display: none;
    }
  </style>
</head>
<body>

  <button class="button" id="scanBarcode">تصوير QR Code</button>
  <div id="scannerContainer">
    <video id="camera"></video>
    <div id="scanArea"></div> <!-- Square marker for QR Code -->
    <button class="button" id="stopScanButton" style="display: none;">إيقاف التصوير</button>
  </div>
  <p id="message" style="display:none;"></p> <!-- Success message after scanning -->

  <script src="https://unpkg.com/qr-scanner/qr-scanner.min.js"></script>
  <script>
    // Variables for scanner
    const scannerContainer = document.getElementById("scannerContainer");
    const video = document.getElementById("camera");
    const stopScanButton = document.getElementById("stopScanButton");
    const message = document.getElementById("message");

    // Start the QR code scanner
    document.getElementById("scanBarcode").addEventListener("click", () => {
      scannerContainer.style.display = "block";
      stopScanButton.style.display = "inline-block";

      // Initialize QR scanner
      const qrScanner = new QrScanner(video, (result) => {
        if (result) {
          // Stop scanning once QR code is read
          qrScanner.stop();
          scannerContainer.style.display = "none";

          // Show success message
          message.textContent = "تم مسح الكود بنجاح!";
          message.style.display = "block";

          // Process data (you can add custom logic here)
          console.log("QR Code Data:", result.data);
        }
      });

      // Start the scanner
      qrScanner.start();
    });

    // Stop scanning when the stop button is clicked
    stopScanButton.addEventListener("click", () => {
      scannerContainer.style.display = "none";
      message.style.display = "none";
      stopScanButton.style.display = "none";
    });
  </script>

</body>
</html>